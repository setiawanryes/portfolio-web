<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Komentar Aktif</title>
<style>
/* ====== STYLE MODAL ====== */
.custom-modal {
  display: none;
  position: fixed;
  z-index: 1000;
  left: 0; top: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.6);
  justify-content: center;
  align-items: center;
}
.custom-modal-content {
  background: #fff;
  padding: 20px;
  border-radius: 12px;
  width: 320px;
  box-shadow: 0 3px 8px rgba(0,0,0,0.3);
}
.close-btn {
  float: right;
  cursor: pointer;
  font-size: 24px;
}
.comment {
  background: #f9f9f9;
  border-radius: 8px;
  padding: 10px;
  margin-top: 10px;
}
.comment-header {
  display: flex;
  align-items: center;
  gap: 10px;
}
.comment-header img {
  width: 40px;
  height: 40px;
  border-radius: 50%;
}
.comment-actions button {
  margin-right: 10px;
  cursor: pointer;
}
.like-dislike-container {
  display: flex;
  align-items: center;
  gap: 5px;
  margin-bottom: 10px;
}
</style>
</head>
<body>

<div class="like-dislike-container">
  <button id="like-btn">‚ù§Ô∏è</button>
  <span id="like-count">0</span>

  <button id="komentar-btn">üí¨</button>
  <span id="komentar-count">0</span>
</div>

<!-- TEMPAT LIST KOMENTAR -->
<div id="comments-list"></div>

<!-- MODAL KOMENTAR -->
<div id="komentarModal" class="custom-modal">
  <div class="custom-modal-content">
    <span id="close-komentar-modal" class="close-btn">&times;</span>
    <h2 id="modal-title">Tulis Komentar</h2>
    <form id="komentar-form">
      <label>Nama *</label>
      <input type="text" id="nama" required>

      <label>Foto (opsional)</label>
      <input type="file" id="foto" accept="image/*">

      <label>Komentar</label>
      <textarea id="isi" rows="3"></textarea>

      <button type="button" id="kirim-btn">Kirim</button>
    </form>
  </div>
</div>

<script>
// ====== VARIABEL GLOBAL ======
let likeCount = 0;
let komentarCount = 0;
let replyTo = null;
const defaultAvatar = "images/default-avatar.png"; // ambil dari folder images

// ====== LIKE ======
document.getElementById("like-btn").addEventListener("click", () => {
  likeCount++;
  document.getElementById("like-count").innerText = likeCount;
});

// ====== BUKA MODAL KOMENTAR ======
document.getElementById("komentar-btn").addEventListener("click", () => {
  replyTo = null;
  document.getElementById("modal-title").innerText = "Tulis Komentar";
  document.getElementById("komentarModal").style.display = "flex";
});

// ====== TUTUP MODAL ======
document.getElementById("close-komentar-modal").addEventListener("click", () => {
  document.getElementById("komentarModal").style.display = "none";
});

// ====== KIRIM KOMENTAR ======
document.getElementById("kirim-btn").addEventListener("click", () => {
  const nama = document.getElementById("nama").value.trim();
  const isi = document.getElementById("isi").value.trim();
  const fotoInput = document.getElementById("foto");

  if (!nama) {
    alert("Nama wajib diisi!");
    return;
  }

  if (fotoInput.files.length > 0) {
    const reader = new FileReader();
    reader.onload = function() {
      buatKomentar(nama, isi, reader.result);
    };
    reader.readAsDataURL(fotoInput.files[0]);
  } else {
    buatKomentar(nama, isi, defaultAvatar);
  }

  document.getElementById("komentarModal").style.display = "none";
  document.getElementById("nama").value = "";
  document.getElementById("foto").value = "";
  document.getElementById("isi").value = "";
});

// ====== FUNGSI BUAT KOMENTAR ======
function buatKomentar(nama, isi, foto) {
  const commentDiv = document.createElement("div");
  commentDiv.classList.add("comment");
  commentDiv.innerHTML = `
    <div class="comment-header">
      <img src="${foto}" alt="avatar">
      <strong>${nama}</strong>
    </div>
    <div class="comment-body">${isi || "(Tanpa isi)"}</div>
    <div class="comment-actions">
      <button class="like-komentar">Suka</button>
      <button class="balas-komentar">Balas</button>
    </div>
  `;

  if (replyTo) {
    replyTo.appendChild(commentDiv);
    replyTo = null;
  } else {
    document.getElementById("comments-list").appendChild(commentDiv);
    komentarCount++;
    document.getElementById("komentar-count").innerText = komentarCount;
  }
}

// ====== LIKE & BALAS KOMENTAR ======
document.addEventListener("click", (e) => {
  if (e.target.classList.contains("like-komentar")) {
    const btn = e.target;
    btn.innerText = btn.innerText === "Suka" ? "‚ù§Ô∏è Disukai" : "Suka";
  }

  if (e.target.classList.contains("balas-komentar")) {
    replyTo = e.target.closest(".comment");
    document.getElementById("modal-title").innerText = "Balas Komentar";
    document.getElementById("komentarModal").style.display = "flex";
  }
});
</script>
</body>
</html>
