<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SI-TANDUR | Roni Setiawan</title>
  <link rel="stylesheet" href="project.css">
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
</head>

<body>
  <section class="project-detail">
    <div class="project-container">

      <!-- NAV -->
      <div class="back-nav">
        <a href="../index.html#portfolio" class="back-btn">‚Üê Back</a>
        <span>Projects / SI-TANDUR</span>
      </div>

      <!-- MAIN LAYOUT (2 KOLOM) -->
      <!-- ROW 1: INFO & PREVIEW -->
    <div class="project-header">
      <!-- KIRI -->
      <div class="left-column" data-aos="fade-right">
    <div class="project-info">
      <h1>SI-TANDUR</h1>
      <p>
       SI-TANDUR is an Integrated Agricultural Information System specifically designed for East Lampung to assist local farmers in monitoring and managing the planting process more efficiently. This system facilitates crop planning, real-time monitoring of plant conditions, and provides care and harvest recommendations based on collected data.

      <div class="project-stats" style="position: relative;">
  <div class="stat" data-info="IoT sensors, cloud storage, and mobile/web apps to monitor crops and provide care tips, harvest forecasts, and alerts.">
    <i class="fas fa-code"></i> 5 Teknologi
  </div>
  <div class="stat" data-info="Crop planning, monitoring, care recommendations, harvest forecasts, reports & statistics, critical alerts, farmer community, AI chat, MSME support, and agricultural store recommendations.">
    <i class="fas fa-cogs"></i> 7 Fitur Utama
  </div>
</div>

<div class="project-buttons">
  <a href="#" class="btn live">Preview</a>
  
  <!-- Progres Bar -->
  <div class="progress-bar-container">
    <div class="progress-bar" id="progress-bar"></div>
    <span id="progress-text">0%</span>
  </div>
  
  <!-- Hati -->
<div class="like-dislike-container">
  <button id="like-btn" class="reaction-btn like-theme">‚ù§Ô∏è</button>
  <span id="like-count">0</span>

<button id="komentar-btn" class="reaction-btn komentar-theme">üí¨</button>
<span id="komentar-count">0</span>
</div>
</div>
</div>

<div class="comment-list">
  <!-- Daftar komentar -->
  <div id="comment-list"></div>
</div>
</div>

  <!-- KANAN (preview) -->
  <div class="right-column" data-aos="fade-left">
  <div class="project-preview">
    <div class="slide-project">
      <img src="../images/project1.png" alt="Preview 1" class="lightbox-img">
      <img src="../images/sertifikat1.jpg" alt="Preview 2" class="lightbox-img">
      <img src="../images/traveler1.jpg" alt="Preview 3" class="lightbox-img">
    </div>
    <div class="slide-controls">
      <button class="prev">‚ùÆ</button>
      <button class="next">‚ùØ</button>
    </div>
  </div>



    <!-- KEY FEATURES -->
    <div class="key-features">
      <h2>‚≠êKey Features of SI-TANDUR</h2>
      <ul>
        <li>Real-Time Crop Monitoring ‚Äì Track crop conditions instantly.</li>
        <li>Care & Harvest Recommendations ‚Äì Advice on fertilization, watering, and harvest forecasts.</li>
        <li>Crop Planning ‚Äì Schedule planting and select seeds.</li>
        <li>AI Chat ‚Äì Virtual agricultural consultation.</li>
        <li>MSME Support & Store Recommendations ‚Äì Market harvests and find nearby agricultural stores.</li>
     </ul>
    </div>
  </div>
</div>
</section>

<!-- Modal komentar -->
<div id="comment-modal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <form id="comment-form">
      <input type="text" id="name-input" placeholder="Nama (wajib)" required>
      <input type="file" id="photo-input" accept="image/*">
      <textarea id="comment-input" placeholder="Tulis komentar..." required></textarea>
      <button type="submit">Kirim</button>
    </form>
  </div>
</div>
<!-- Modal / Tooltip di dalam container -->
  <div id="miniModal" class="mini-modal">
    <div class="mini-content" id="miniContent"></div>
  </div>
</div>
<!-- Modal lightbox -->
<div id="lightboxModal" class="modal">
  <span class="close">&times;</span>
  <img class="modal-content" id="lightboxImg">
  <div class="modal-controls">
    <button id="prevImg">‚ùÆ</button>
    <button id="nextImg">‚ùØ</button>
  </div>
</div>

<script>
  const komentarBtn = document.getElementById('komentar-btn');
const komentarCount = document.getElementById('komentar-count');
const modal = document.getElementById('comment-modal');
const closeModal = document.querySelector('.close');
const commentForm = document.getElementById('comment-form');
const commentList = document.getElementById('comment-list');

const defaultPhoto = 'https://via.placeholder.com/50';
let komentarNumber = 0;

// Buka modal
komentarBtn.addEventListener('click', () => { modal.style.display = 'flex'; });

// Tutup modal
closeModal.addEventListener('click', () => { modal.style.display = 'none'; });
window.addEventListener('click', e => { if(e.target === modal) modal.style.display = 'none'; });

// Submit komentar
commentForm.addEventListener('submit', (e) => {
  e.preventDefault();
  
  const nameInput = document.getElementById('name-input');
  const commentInput = document.getElementById('comment-input');
  const photoInput = document.getElementById('photo-input');

  const name = nameInput.value.trim();
  const text = commentInput.value.trim();
  const photoFile = photoInput.files[0];

  if(!name || !text) return;

  // Fungsi untuk menambahkan komentar
  const processComment = (photoURL) => {
    addComment(name, text, photoURL);
    commentForm.reset();
    modal.style.display = 'none';
    komentarNumber++;
    komentarCount.textContent = komentarNumber;
  };

  if(photoFile){
    const reader = new FileReader();
    reader.onload = function(event){
      processComment(event.target.result);
    }
    reader.readAsDataURL(photoFile);
  } else {
    processComment(defaultPhoto);
  }
});

// Fungsi tambah komentar / reply
function addComment(name, text, photo){
  const date = new Date().toLocaleString();
  const commentItem = document.createElement('div');
  commentItem.className = 'comment-item';

  commentItem.innerHTML = <img src="${photo}" alt="Profile">
    <div class="comment-content">
      <div class="comment-header"><span>${name}</span><span>${date}</span></div>
      <div class="comment-text">${text}</div>
      <div class="comment-actions">
        <span class="like-btn">‚ù§Ô∏è Like (0)</span>
        <span class="unlike-btn">üëé Unlike (0)</span>
        <span class="reply-btn">üí¨ Balas</span>
      </div>
      <div class="reply-list"></div>
    </div>
  ;

  const likeBtn = commentItem.querySelector('.like-btn');
  const unlikeBtn = commentItem.querySelector('.unlike-btn');
  const replyBtn = commentItem.querySelector('.reply-btn');
  const replyList = commentItem.querySelector('.reply-list');

  // Like / Unlike
  let likeCount = 0, unlikeCount = 0;
  likeBtn.addEventListener('click', () => {
    likeCount++;
    likeBtn.textContent = `‚ù§Ô∏è Like (${likeCount})`;
  });
  unlikeBtn.addEventListener('click', () => {
    unlikeCount++;
    unlikeBtn.textContent = `üëé Unlike (${unlikeCount})`;
  });

  // Reply ‚Üí buka modal, dan kirim reply sebagai komentar baru
  replyBtn.addEventListener('click', () => {
    modal.style.display = 'flex';

    // Ganti event listener sementara agar reply masuk ke parent komentar
    const submitHandler = (e) => {
      e.preventDefault();
      const replyName = document.getElementById('name-input').value.trim();
      const replyText = document.getElementById('comment-input').value.trim();
      const replyPhotoFile = document.getElementById('photo-input').files[0];
      if(!replyName || !replyText) return;

      const processReply = (photoURL) => {
        const replyItem = document.createElement('div');
        replyItem.style.marginLeft = '20px';
        replyItem.style.marginTop = '5px';
        replyItem.className = 'comment-item';
        replyItem.innerHTML = <img src="${photoURL}"alt="Profile">
          <div class="comment-content">
            <div class="comment-header"><span>${replyName}</span><span>${new Date().toLocaleString()}</span></div>
            <div class="comment-text">${replyText}</div>
            <div class="comment-actions">
              <span class="like-btn">‚ù§Ô∏è Like (0)</span>
              <span class="unlike-btn">üëé Unlike (0)</span>
            </div>
          </div>
        ;
        // Like / Unlike reply
        let rLike=0,rUnlike=0;
        replyItem.querySelector('.like-btn').addEventListener('click', e=>{
          rLike++; e.target.textContent=`‚ù§Ô∏è Like (${rLike})`;
        });
        replyItem.querySelector('.unlike-btn').addEventListener('click', e=>{
          rUnlike++; e.target.textContent=`üëé Unlike (${rUnlike})`;
        });
        replyList.appendChild(replyItem);
        modal.style.display='none';
        commentForm.removeEventListener('submit', submitHandler);
        commentForm.reset();
      }

      if(replyPhotoFile){
        const reader = new FileReader();
        reader.onload = e => processReply(e.target.result);
        reader.readAsDataURL(replyPhotoFile);
      } else {
        processReply(defaultPhoto);
      }
    };

    commentForm.addEventListener('submit', submitHandler);
  });

  commentList.prepend(commentItem);
}

</script>
<script src="project.js"></script>

</body>
</html>
