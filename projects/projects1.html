<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SI-TANDUR | Roni Setiawan</title>
  <link rel="stylesheet" href="project.css">
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
</head>

<body>
  <section class="project-detail">
    <div class="project-container">

      <!-- NAV -->
      <div class="back-nav">
        <a href="../index.html#portfolio" class="back-btn">‚Üê Back</a>
        <span>Projects / SI-TANDUR</span>
      </div>

      <!-- MAIN LAYOUT (2 KOLOM) -->
      <!-- ROW 1: INFO & PREVIEW -->
    <div class="project-header">
      <!-- KIRI -->
      <div class="left-column" data-aos="fade-right">
    <div class="project-info">
      <h1>SI-TANDUR</h1>
      <p>
       SI-TANDUR is an Integrated Agricultural Information System specifically designed for East Lampung to assist local farmers in monitoring and managing the planting process more efficiently. This system facilitates crop planning, real-time monitoring of plant conditions, and provides care and harvest recommendations based on collected data.

      <div class="project-stats" style="position: relative;">
  <div class="stat" data-info="IoT sensors, cloud storage, and mobile/web apps to monitor crops and provide care tips, harvest forecasts, and alerts.">
    <i class="fas fa-code"></i> 5 Teknologi
  </div>
  <div class="stat" data-info="Crop planning, monitoring, care recommendations, harvest forecasts, reports & statistics, critical alerts, farmer community, AI chat, MSME support, and agricultural store recommendations.">
    <i class="fas fa-cogs"></i> 7 Fitur Utama
  </div>
</div>

<div class="project-buttons">
  <a href="#" class="btn live">Preview</a>
  
  <!-- Progres Bar -->
  <div class="progress-bar-container">
    <div class="progress-bar" id="progress-bar"></div>
    <span id="progress-text">0%</span>
  </div>
  
  <!-- Hati -->
<div class="like-dislike-container">
  <button id="like-btn" class="reaction-btn like-theme">‚ù§Ô∏è</button>
  <span id="like-count">0</span>

  <button id="komentar-btn" class="reaction-btn komentar-theme">üí¨</button>
    <span id="komentar-count">0</span>
  </div>
</div>
</div>
      <div>
  <!-- Daftar Komentar -->
  <div id="comments-list"></div>
</div>
</div>

  <!-- KANAN (preview) -->
  <div class="right-column" data-aos="fade-left">
  <div class="project-preview">
    <div class="slide-project">
      <img src="../images/project1.png" alt="Preview 1" class="lightbox-img">
      <img src="../images/sertifikat1.jpg" alt="Preview 2" class="lightbox-img">
      <img src="../images/traveler1.jpg" alt="Preview 3" class="lightbox-img">
    </div>
    <div class="slide-controls">
      <button class="prev">‚ùÆ</button>
      <button class="next">‚ùØ</button>
    </div>
  </div>



    <!-- KEY FEATURES -->
    <div class="key-features">
      <h2>‚≠êKey Features of SI-TANDUR</h2>
      <ul>
        <li>Real-Time Crop Monitoring ‚Äì Track crop conditions instantly.</li>
        <li>Care & Harvest Recommendations ‚Äì Advice on fertilization, watering, and harvest forecasts.</li>
        <li>Crop Planning ‚Äì Schedule planting and select seeds.</li>
        <li>AI Chat ‚Äì Virtual agricultural consultation.</li>
        <li>MSME Support & Store Recommendations ‚Äì Market harvests and find nearby agricultural stores.</li>
     </ul>
    </div>
  </div>
</div>
</section>

<!-- Modal Komentar (nama class & id unik) -->
  <div id="komentarModal" class="komentar-modal">
    <div class="komentar-modal-content">
      <span class="close-btn" id="close-komentar-modal">&times;</span>
      <h3 id="modal-title">Tulis Komentar</h3>

      <input type="text" id="nama" placeholder="Nama Anda *" required />
      <input type="file" id="foto" accept="image/*" />
      <textarea id="isi" rows="3" placeholder="Tulis komentar Anda..."></textarea>

      <button id="kirim-btn">Kirim</button>
    </div>
  </div>
<!-- Modal / Tooltip di dalam container -->
  <div id="miniModal" class="mini-modal">
    <div class="mini-content" id="miniContent"></div>
  </div>
</div>
<!-- Modal lightbox -->
<div id="lightboxModal" class="modal">
  <span class="close">&times;</span>
  <img class="modal-content" id="lightboxImg">
  <div class="modal-controls">
    <button id="prevImg">‚ùÆ</button>
    <button id="nextImg">‚ùØ</button>
  </div>
</div>

<script>
// ====== Inisialisasi variabel global ======
let likeCount = 0;
let komentarCount = 0;
let replyTo = null; // Menyimpan elemen komentar yang sedang dibalas
const defaultAvatar = "images/default-avatar.png"; // Avatar default dari folder images

// ====== Tombol Like utama ======
document.getElementById("like-btn").addEventListener("click", () => {
  likeCount++;
  document.getElementById("like-count").innerText = likeCount;
});

// ====== Buka Modal Komentar ======
document.getElementById("komentar-btn").addEventListener("click", () => {
  replyTo = null; // reset mode balasan
  document.getElementById("modal-title").innerText = "Tulis Komentar";
  document.getElementById("komentarModal").style.display = "flex";
});

// ====== Tutup Modal ======
document.getElementById("close-komentar-modal").addEventListener("click", () => {
  document.getElementById("komentarModal").style.display = "none";
});

// ====== Tombol Kirim Komentar ======
document.getElementById("kirim-btn").addEventListener("click", () => {
  const nama = document.getElementById("nama").value.trim();
  const isi = document.getElementById("isi").value.trim();
  const fotoInput = document.getElementById("foto");

  if (!nama) return alert("Nama wajib diisi!"); // Validasi nama

  // Jika user upload foto, pakai FileReader untuk preview
  if (fotoInput.files.length > 0) {
    const reader = new FileReader();
    reader.onload = function() {
      buatKomentar(nama, isi, reader.result);
    };
    reader.readAsDataURL(fotoInput.files[0]);
  } else {
    // Kalau tidak upload, pakai avatar default
    buatKomentar(nama, isi, defaultAvatar);
  }

  // Tutup modal & reset form
  document.getElementById("komentarModal").style.display = "none";
  document.getElementById("nama").value = "";
  document.getElementById("foto").value = "";
  document.getElementById("isi").value = "";
});

// ====== Fungsi membuat komentar baru ======
function buatKomentar(nama, isi, foto) {
  const commentDiv = document.createElement("div");
  commentDiv.classList.add("comment");

  commentDiv.innerHTML = `
    <div class="comment-header">
      <img src="${foto}" alt="avatar">
      <strong>${nama}</strong>
    </div>
    <div class="comment-body">${isi || "(Tanpa isi)"}</div>
    <div class="comment-actions">
      <button class="like-komentar">Suka</button>
      <button class="balas-komentar">Balas</button>
    </div>
  `;

  if (replyTo) {
    replyTo.appendChild(commentDiv); // kalau ini balasan
    replyTo = null;
  } else {
    document.getElementById("comments-list").appendChild(commentDiv); // komentar baru
    komentarCount++;
    document.getElementById("komentar-count").innerText = komentarCount;
  }
}

// ====== Like & Balas Komentar (Event Delegation) ======
document.addEventListener("click", (e) => {
  // Like komentar
  if (e.target.classList.contains("like-komentar")) {
    const btn = e.target;
    btn.innerText = btn.innerText === "Suka" ? "‚ù§Ô∏è Disukai" : "Suka";
  }

  // Balas komentar
  if (e.target.classList.contains("balas-komentar")) {
    replyTo = e.target.closest(".comment");
    document.getElementById("modal-title").innerText = "Balas Komentar";
    document.getElementById("komentarModal").style.display = "flex";
  }
});
</script>

<script src="project.js"></script>

</body>
</html>
